<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Construct and Check Targets Input — process_targets • optweight</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Construct and Check Targets Input — process_targets"><meta name="description" content="Checks whether proposed target population means values for targets are suitable in number and order for submission to optweight(), optweightMV(), and optweight.svy(), and returns an object that can supplied to the targets argument of these functions."><meta property="og:description" content="Checks whether proposed target population means values for targets are suitable in number and order for submission to optweight(), optweightMV(), and optweight.svy(), and returns an object that can supplied to the targets argument of these functions."><meta property="og:image" content="https://ngreifer.github.io/optweight/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">optweight</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/optweight.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ngreifer/optweight/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Construct and Check Targets Input</h1>
      <small class="dont-index">Source: <a href="https://github.com/ngreifer/optweight/blob/master/R/process_targets.R" class="external-link"><code>R/process_targets.R</code></a></small>
      <div class="d-none name"><code>process_targets.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Checks whether proposed target population means values for <code>targets</code> are suitable in number and order for submission to <code><a href="optweight.html">optweight()</a></code>, <code><a href="optweightMV.html">optweightMV()</a></code>, and <code><a href="optweight.svy.html">optweight.svy()</a></code>, and returns an object that can supplied to the <code>targets</code> argument of these functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">process_targets</span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="cn">NULL</span>, targets <span class="op">=</span> <span class="cn">NULL</span>, s.weights <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">check.targets</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'optweight.targets'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">5</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a formula with nothing on the left hand side and the covariates to be targeted on the right hand side. Interactions and functions of covariates are allowed. Can be omitted, in which case all variables in <code>data</code> are assumed targeted. If <code>data</code> is <code>NULL</code> and <code>formula</code> is a data.frame, <code>data</code> will be replaced with <code>formula</code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data set in the form of a data frame that contains the variables in <code>formula</code>.</p></dd>


<dt id="arg-targets">targets<a class="anchor" aria-label="anchor" href="#arg-targets"></a></dt>
<dd><p>a vector of target population mean values for each covariate. These should be in the order corresponding to the order of the corresponding variable in <code>formula</code>, except for interactions, which will appear after all lower-order terms. For factor variables, a target value must be specified for each level of the factor, and these values must add up to 1. If <code>NULL</code>, the current sample means will be produced (weighted by <code>s.weights</code>). If <code>NA</code>, an <code>NA</code> vector named with the covariate names will be produced.</p></dd>


<dt id="arg-s-weights">s.weights<a class="anchor" aria-label="anchor" href="#arg-s-weights"></a></dt>
<dd><p>a vector of sampling weights. For <code><a href="optweight.html">optweight()</a></code>, can also be the name of a variable in <code>data</code> that contains sampling weights.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>for <code><a href="optweight.html">optweight()</a></code>, additional arguments passed to <code><a href="optweight.html">optweight.fit()</a></code>, including options that are passed to the settings function corresponding to <code>solver</code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an <code>optweight.targets</code> object; the output of a call to <code>process_targets()</code>.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>how many digits to print.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>optweight.targets</code> object, which is a named vector of target population mean values, one for each (expanded) covariate specified in <code>formula</code>. This should be used as an input to the <code>targets</code> argument of <code><a href="optweight.html">optweight()</a></code>, <code><a href="optweightMV.html">optweightMV()</a></code>, and <code><a href="optweight.svy.html">optweight.svy()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The purpose of <code>process_targets()</code> is to allow users to ensure that their proposed input to <code>targets</code> in <code><a href="optweight.html">optweight()</a></code>, <code><a href="optweightMV.html">optweightMV()</a></code>, and <code><a href="optweight.svy.html">optweight.svy()</a></code> is correct both in the number of entries and their order. This is especially important when factor variables and interactions are included in the formula because factor variables are split into several dummies and interactions are moved to the end of the variable list, both of which can cause some confusion and potential error when entering <code>targets</code> values.</p>
<p>Factor variables are internally split into a dummy variable for each level, so the user must specify a target population mean value for each level of the factor. These must add up to 1, and an error will be displayed if they do not. These values represent the proportion of units in the target population with each factor level.</p>
<p>Interactions (e.g., <code>a:b</code> or <code>a*b</code> in the <code>formula</code> input) are always sent to the end of the variable list even if they are specified elsewhere in the <code>formula</code>. It is important to run <code>process_targets()</code> to ensure the order of the proposed <code>targets</code> corresponds to the represented order of covariates used in the formula. You can run <code>process_targets(., targets = NA)</code> to see the order of covariates that is required without specifying any targets.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="process_tols.html">process_tols()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ngreifer.github.io/cobalt/" class="external-link">"cobalt"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span>, package <span class="op">=</span> <span class="st">"cobalt"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generating targets; means by default</span></span></span>
<span class="r-in"><span><span class="va">targets</span> <span class="op">&lt;-</span> <span class="fu">process_targets</span><span class="op">(</span><span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                             <span class="va">nodegree</span> <span class="op">+</span> <span class="va">re74</span>,</span></span>
<span class="r-in"><span>                           data <span class="op">=</span> <span class="va">lalonde</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Notice race is split into three values</span></span></span>
<span class="r-in"><span><span class="va">targets</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - <span style="font-style: italic;">targets</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         age  race_black race_hispan  race_white     married    nodegree </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    27.36319     0.39577     0.11726     0.48697     0.41531     0.63029 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        re74 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4557.54657 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generating targets; NA by default</span></span></span>
<span class="r-in"><span><span class="va">targets</span> <span class="op">&lt;-</span> <span class="fu">process_targets</span><span class="op">(</span><span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">married</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                             <span class="va">nodegree</span> <span class="op">+</span> <span class="va">re74</span>,</span></span>
<span class="r-in"><span>                           data <span class="op">=</span> <span class="va">lalonde</span>,</span></span>
<span class="r-in"><span>                           targets <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">targets</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - <span style="font-style: italic;">variables</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	age   race_black   race_hispan   race_white   married   nodegree   re74</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Can also supply just a dataset</span></span></span>
<span class="r-in"><span><span class="va">covs</span> <span class="op">&lt;-</span> <span class="va">lalonde</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">race</span>, <span class="va">married</span>,</span></span>
<span class="r-in"><span>                    <span class="va">nodegree</span>, <span class="va">re74</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">targets</span> <span class="op">&lt;-</span> <span class="fu">process_targets</span><span class="op">(</span><span class="va">covs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">targets</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - <span style="font-style: italic;">targets</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         age  race_black race_hispan  race_white     married    nodegree </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    27.36319     0.39577     0.11726     0.48697     0.41531     0.63029 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        re74 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4557.54657 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Noah Greifer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

